# TIL1203

## (1) Project Issue

- 흑백/컬러 이미지 2만장
  - 잘착용 10000장
  - 미착용/불량착용
    - 맨얼굴 10000장
    - 코스크 10000장

- 마스크 합성이미지로 학습한 모델의 정확성이 보장되지 않는다면 다시 실착 마스크 이미지로 학습을 시켜본다. (https://www.kaggle.com/dhruvmak/face-mask-detection / 193MB)
  - 코스크, 턱스크를 분류할 때는 haar cascade의 좌표추출이 아닌 음양값 탐지로 코, 턱을 분류해본다.

- 현재 컬러이미지로 3중분류(3만장)로 학습된 모델은 맨얼굴 중에 썼다고 판단하는 오분류는 없음. 다만 마스크 썼다고 판단한 것중에 측면 코스크를 썼다고 판단하는 오분류가 있어서 측면마스크 합성 고려중



## (2) Haar Cascade

> reference : https://webnautes.tistory.com/1352
>
> **정의**
>
> 머신러닝 기반의 오브젝트 검출 알고리즘이다. 2001년 논문에서 제안되었으며 특징을 기반으로 비디오 또는 이미지에서 오브젝트를 검출하기 위해 사용된다. 찾으려는 오브젝트(얼굴)가 포함된 이미지와 오브젝트가 없는 이미지를 사용하여 Haar Cascade Classifier(하르 특징 분류기)를 학습시킨다. 그러고나서 분류기를 사용하여 오브젝트를 검출한다.
>
> **특징**
>
> ![Haar Cascade](https://user-images.githubusercontent.com/64063767/100975500-77afdf00-3581-11eb-9fb0-0364e99f27a2.png)
>
> Adaboost Training : 16000개 이상의 특징이 검출되는데 얼굴 검출을 하는데 도움이 되는 의미있는 특징을 골라내야 한다. 이 때 처리 성능을 향상시키기 위해 Adaboost를 사용한다.
>
> 앞서 구한 특징 중 대부분은 의미가 없는 특징이다. 예를 들어 위의 그림에서 두가지 하르 특징은 눈 주위에서만 의미있는 특징이다. 즉, 이 두개의 하르 특징은 눈 근처에서만 의미있는 값을 내놓는다.
>
> - 가로 방향으로 검은색 사각영역과 흰색 사각영역이 있는 특징의 경우에는 코와 뺨보다 눈 부분이 더 어둡다는 특성을 사용한다.
> - 세로 방향으로 흰색 사각영역이 있고 좌우에 검은색 사각 영역이 있는 특징의 경우에는 중앙에 있는 코보다 양쪽에 있는 눈 부분이 더 어둡다는 특성을 사용한다.
>
> 최적의 특징을 선택하기 위해 모든 학습 이미지에 특징을 적용한다. 각 특징에 대해 얼굴이 포함된 이미지와 얼굴이 없는 이미지를 분류하기 위한 최적의 임계값(threshold)을 찾는다. (흰색 영역과 검은색 영역의 차이가 일정 임계값 이상이면 얼굴을 위한 특징이라 보는 것 / 얼굴이 아닌 영역에서는 두 영역간의 차이가 거의 없을거라고 보고 만든 알고리즘)



- 미리 학습시켜 놓은 XML 포맷으로 저장된 분류기 중 코 분류기는 외부에서 다운로드
  - https://github.com/adobe/SimpleSensor/tree/master/simplesensor/collection_modules/demographic_camera/classifiers/haarcascades
