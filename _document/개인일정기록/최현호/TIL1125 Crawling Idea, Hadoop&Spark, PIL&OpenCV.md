# TIL1125

### 뉴스 제목 및 본문글 크롤링

- 네이버(다음) 뉴스에서 턱스크(코스크) 검색시 뉴스기사들의 제목과 본문 내용을 크롤링
- 기사 제목에 자주 등장하는 단어(지하철, 대중교통, 영화관? 등 공공시설관련 단어)를 워드클라우드로 시각화
- 많이 등장하는 단어 순위를 매겨서 20개까지 막대그래프로 시각화
- 즉, 지하철이나 공공시설에서 코스크나 턱스크로 인한 시민들간의 불필요한 마찰을 야기한다.
- 우리 서비스는 이러한 것들을 사전에 방지하기 위해 출입 게이트에서 부터 마스크 착용여부를 가리고
- 영화관이나 지하철 등의 공공시설 안에서 다중인식 센서로 마스크 불량착용자를 인식하여 관리자에게 알림 메시지를 보낸다
- 시민들이 직접신고하지 않고도 관리자가 적절한 조치(직접요청, 안내방송 등)를 취하도록하여 시민들이 느끼는 불안감을 해소하고 불필요한 마찰을 줄인다.



#### 빅데이터 필요 기술

> Spark를 이용하면 SQL과 같은 데이터를 처리하는 툴 사용, 구조화된 데이터 처리, 머신러닝, 그래프 데이터 프로세싱을 배울 수 있다.

| Hadoop                                                       | Spark                                                        |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| 이상 탐지 시스템을 구축하기에 적절한 환경을 제공             | 스파크는 **실시간 처리**가 가능                              |
| 일괄처리 방식, 실시간 스트리밍 데이터 처리 방식이 가능       | 스파크 스트리밍 프레임워크는 여전히 마이크로배치(micro-batch)이다. |
| 시스템을 구현하는 방식에 따른 각각의 다른 각 구성의 요소에 활용되는 소프트웨어 솔루션까지 제어 | 마이크로 배치는 계속 들어오는 스트림 데이터를 초 단위로 잘라 처리한다 |
| 단점은 실시간 처리에 따른 요구 사항을 맞춰 변화하기엔 굉장히 속도가 느림 | 마이크로 배치의 큰 장점은 데이터 처리량이 높고 운영 효용성과 비용 측면에서도 유리하다 |

- **이미지 전처리**
  - AWS jupyterlab에서 python으로 이미지 전처리 해보다가 속도가 느린것 같으면 pyspark로 이미지 전처리 수행해보기; 속도차이 체감해보기
- **수치 시각화** 
  - 코로나 현황 (from 공공데이터포털 Open API) 수치를 통계내어 추이를 나타내기
  - 경찰에 따르면 대중교통 내 마스크 착용 시비로 폭행 혐의 건수 증가
    - https://www.ikbn.news/mobile/article.html?no=106918
    - https://www.yonhapnewstv.co.kr/news/MYH20201005006900641
    - http://www.hani.co.kr/arti/society/society_general/959892.html
    - 마스크 미착용 관련 112에 접수된 신고 4796건(8.30~9.3) <-- 일주일 전과 비교하면 52% 증가된 수치
- **지도 시각화**
  - 게이트에서 마스크 미착용자 적발시 가까운 (약국)을 지도시각화하여 관리자 display에 팝업
- **텍스트 크롤링**
  - 뉴스 기사 크롤링(python 크롤링 후 csv 저장 -> R에서 워드클라우드 시각화 해보기?)



#### CPU vs GPU

GPU는 병렬연산을 수행하여 머신러닝에 적합



#### PIL vs OpenCV (이미지 전처리)

- Pillow Performance : https://python-pillow.org/pillow-perf/
- 두 라이브러리 성능 비교
  - PIL 라이브러리의 경우는 OpenCV보다 전체적인 성능이 떨어진다. 
  - 하지만 PIL로 부터 fork된 Pillow-SIMD 라이브러리의 경우 OpenCV와 대등한 성능을 내거나 더 좋은 성능을 내는 항목이 많았다.

| OpenCV                                                       | PIL                                                          |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| BGR로 이미지를 읽어옴                                        | RGB로 이미지를 읽어옴                                        |
| Video capture와 같은 기능 지원이 잘 되어있음                 | torchvision에서의 지원이 잘되어있음                          |
| PIL에는 없는 다양한 함수들 지원(PIL에 있는 거의 모든 기능이 OpenCV에 존재) | numpy array와의 암묵적 casting이 안되고, numpy array를 Image array로 바꿔줘야함 |
| cv2 함수의 입력으로 numpy array를 넣어서 바로 사용가능(numpy array와의 호환성이 좋음) | numpy array 인덱싱을 이용해 이미지 전처리 불가               |
| numpy array 인덱싱을 이용해 자유로운 이미지 전처리가 가능    |                                                              |
| torchvision과의 호환성은 안좋음(그렇지만 opencv와 호환되는 torchvision 버전도 존재-Not Offical Code) |                                                              |



#### Resize

- OpenCV는cv2.resize() 함수로 이미지 크기를 변환하는 Resizing 기능을 제공

- interpolation은 보간방법 매개변수로 이미지를 확대할 때에는 cv2.INTER_CUBIC 또는 cv2.INTER_LINEAR(default)을 권장한다

- cv2.INTER_CUBIC을 사용하면 좀더 선명한 이미지를 얻을 수 있지만 처리속도가 상대적으로 느림 (동영상을 처리하거나 큰 이미지를 처리할 때 체감)

- 이미지를 축소할때에는 cv.INTER_AREA를 권장